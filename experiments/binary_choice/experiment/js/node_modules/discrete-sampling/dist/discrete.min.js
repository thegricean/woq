(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){function _sum(a,b){return a+b}function _fillArrayWithNumber(size,num){return Array.apply(null,Array(size)).map(Number.prototype.valueOf,num)}function _rangeFunc(upper){var i=0,out=[];while(i<upper)out.push(i++);return out}function _samplerFunction(size){if(!this.draw){throw new Error("Distribution must specify a draw function.")}var result=[];while(size--){result.push(this.draw())}return result}var _samplerPrototype={sample:_samplerFunction};exports.Bernoulli=function(p){var result=Object.create(_samplerPrototype);result.draw=function(){return Math.random()<p?1:0};result.toString=function(){return"Bernoulli( "+p+" )"};return result};exports.Binomial=function(n,p){var result=Object.create(_samplerPrototype),bern=exports.Bernoulli(p);result.draw=function(){return bern.sample(n).reduce(_sum,0)};result.toString=function(){return"Binom( "+[n,p].join(", ")+" )"};return result};exports.Discrete=function(probs){var result=Object.create(_samplerPrototype),k=probs.length;result.draw=function(){var i,p;for(i=0;i<k;i++){p=probs[i]/probs.slice(i).reduce(_sum,0);if(exports.Bernoulli(p).draw())return i}return k-1};result.sampleNoReplace=function(size){if(size>probs.length){throw new Error("Sampling without replacement, and the sample size exceeds vector size.")}var disc,index,sum,samp=[];var currentProbs=probs;var live=_rangeFunc(probs.length);while(size--){sum=currentProbs.reduce(_sum,0);currentProbs=currentProbs.map(function(x){return x/sum});disc=exports.Discrete(currentProbs);index=disc.draw();samp.push(live[index]);live.splice(index,1);currentProbs.splice(index,1);sum=currentProbs.reduce(_sum,0);currentProbs=currentProbs.map(function(x){return x/sum})}currentProbs=probs;live=_rangeFunc(probs.length);return samp};result.toString=function(){return"Dicrete( ["+probs.join(", ")+"] )"};return result};exports.Multinomial=function(n,probs){var result=Object.create(_samplerPrototype),k=probs.length,disc=exports.Discrete(probs);result.draw=function(){var draw_result=_fillArrayWithNumber(k,0),i=n;while(i--){draw_result[disc.draw()]+=1}return draw_result};result.toString=function(){return"Multinom( "+n+", ["+probs.join(", ")+"] )"};return result};exports.NegBinomial=function(r,p){var result=Object.create(_samplerPrototype);result.draw=function(){var draw_result=0,failures=r;while(failures){exports.Bernoulli(p).draw()?draw_result++:failures--}return draw_result};result.toString=function(){return"NegBinomial( "+r+", "+p+" )"};return result};exports.Poisson=function(lambda){var result=Object.create(_samplerPrototype);result.draw=function(){var draw_result,L=Math.exp(-lambda),k=0,p=1;do{k++;p=p*Math.random()}while(p>L);return k-1};result.toString=function(){return"Poisson( "+lambda+" )"};return result};exports.sample_from_array=function(array,numSamples,withReplacement){var n=numSamples||1,result=[],copy,disc,index;if(!withReplacement&&numSamples>array.length){throw new Error("Sampling without replacement, and the sample size exceeds vector size.")}if(withReplacement){while(numSamples--){disc=exports.Discrete(_fillArrayWithNumber(array.length,1));result.push(array[disc.draw()])}}else{copy=array.slice(0);while(numSamples--){disc=exports.Discrete(_fillArrayWithNumber(copy.length,1));index=disc.draw();result.push(copy[index]);copy.splice(index,1)}}return result};window.SJS=window.Sampling=exports},{}]},{},[1]);
